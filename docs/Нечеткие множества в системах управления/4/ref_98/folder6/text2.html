<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.0 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<META NAME="Author" CONTENT="В.Д. Бобко, А.А. Нестеров. & Тимиртдинов Ю.А.">   
<META NAME="KeyWords" CONTENT="Fuzzy, нечеткое управление, Fuzzy Technologies, принцип максимума, ПИД-регулятор, Fuzzy logic">
<META NAME="Description" CONTENT="В задаче управления, оптимального по минимуму квадрата ошибки, предложен алгоритм 
вычисления начальных условий сопряженной системы. Получены дифференциальные уравнения 
для используемых в алгоритме вспомогательных функций. Приведены рекомендации по выбору 
начальных приближений для искомых величин. Обсуждены вопросы сходимости и области 
применения предлагаемого алгоритма. Приведены результаты численного эксперимента.">

<TITLE>СТАТЬЯ: "Вычисление начальных условий сопряженной системы в задаче 
управления с кквадратичным критерием качества"</TITLE>
</HEAD>

<BODY BGCOLOR="#C0C0C0" TEXT="#000000" LINK="#000080" VLINK="#800080" ALINK="#FF0000" 
BACKGROUND="../../back1.gif"  BGPROPERTIES=FIXED>

<TABLE CELLPADDING=0 CELLSPACING=0 WIDTH=100% BORDER=0>
<TR>
<TD><FONT SIZE=-2><A HREF="../../publ.html">Список трудов</A></FONT> </TD>
<TD ALIGN="RIGHT"><B><FONT SIZE=+1><FONT COLOR=#800080>Fuzzy Technologies Lab.</FONT></FONT></B> </TD>
</TR></TABLE><HR SIZE=2>

<FONT SIZE=-1>УДК 51 + 517.9 + 519.6</FONT>
<BLOCKQUOTE>
<CENTER>
<H3>Вычисление начальных условий сопряженной системы <BR>в задаче управления 
с квадратичным критерием качества</H3>
<H4>В.Д.Бобко,  А.А.Нестеров</H4>

Лаборатория нечетких технологий<BR>
Институт автоматики и электрометрии<BR>
Сибирское отделение РАН<BR>
630090 Новосибирск, просп. ак. Коптюга, 1<BR>
Россия<BR>
Тел.: (3832) 33 26 25, <BR>
Факс: (3832) 33 38 63<BR>
<A HREF="MAILTO:zolotukhin@iae.nsk.su ">E-mail: zolotukhin@iae.nsk.su</A> <BR>

</CENTER>


<P>В задаче управления, оптимального по минимуму квадрата ошибки, предложен алгоритм 
вычисления начальных условий сопряженной системы. Получены дифференциальные уравнения 
для используемых в алгоритме вспомогательных функций. Приведены рекомендации по выбору 
начальных приближений для искомых величин. Обсуждены вопросы сходимости и области 
применения предлагаемого алгоритма. Приведены результаты численного эксперимента.
<P>
<P><B>1.</B> Реализация оптимальных систем сталкивается с трудностями вычисления начальных 
условий сопряженной системы. Задача вычисления этих начальных условий остается актуальной, 
несмотря на большое количество работ, посвященных данной проблеме. Мы рассмотрим один из 
методов решения этой задачи для линейной системы с квадратичным критерием качества, 
фиксированным временем управления и отсутствием ограничений на правом конце траектории.
Пусть управляемая система описывается уравнением<BR><A NAME="#form1"></A>
<CENTER><IMG SRC="image75.gif" WIDTH=103 HEIGHT=29 HSPACE=5 VSPACE=5 BORDER=0 ALIGN="MIDDLE">
 <FONT SIZE=+1><NOBR>X(0)=X<SUB>0</SUB></NOBR></FONT>  (1)</CENTER><BR>
где <BR>
X(t)  <I>n</I>-мерный вектор координат управляемой системы, <BR>
U(t)  - <I>  r-</I>мерный вектор управляющих параметров,<BR>
A  и B - матрицы размерности <NOBR>(n x n)</NOBR>  и <NOBR>(n x r)</NOBR> соответственно. <BR>
Управляющие параметры подчинены ограничениям<BR><A NAME="form2"></A>
<CENTER><IMG SRC="image83.gif" WIDTH=50 HEIGHT=25 ALIGN="MIDDLE">    
<IMG SRC="image84.gif" WIDTH=46 HEIGHT=24 ALIGN="MIDDLE"> (2)</CENTER><BR>
Необходимо определить управление U(t), удовлетворяющее условиям (2) и минимизирующий функционал<BR>
<A NAME="form3"></A>
<CENTER><IMG SRC="image86.gif" WIDTH=106 HEIGHT=50 ALIGN="MIDDLE"> (3)</CENTER><BR>
при заданных начальных условиях X<SUB>0</SUB>, фиксированном <I>T </I>и свободном правом конце <I>X(T)</I> 
траектории управляемой системы. Здесь <I>D</I>-положительно определенная симметричная матрица 
<NOBR>(n x n)</NOBR>, (*) операция транспонирования. К такой постановке сводится, например, задача отработки 
начального рассогласования с минимумом среднего квадрата ошибки на фиксированном интервале [0,T].

В соответствии с "принципом максимума" <A HREF="#lit1">[1]</A> поставленная задача решается соотношением <BR>
<A NAME="form4"></A>
<CENTER><IMG SRC="image89.gif" WIDTH=345 HEIGHT=30 ALIGN="MIDDLE"> (4)</CENTER><BR>
где сопряженный вектор P(t)  определяется уравнением<BR><A NAME="form5"></A>
<CENTER><IMG SRC="image91.gif" WIDTH=102 HEIGHT=26 ALIGN="MIDDLE">  (5)</CENTER><BR>
и условиями трансверсальности<BR><A NAME="form6"></A>
<CENTER> P(T) = 0. (6)</CENTER><BR>
<P>Соотношения <A HREF="#form1">(1)</A>, (4), (5) и (6) полностью решают поставленную задачу, но в 
вычислительном 
отношении 
они очень неудобны, так как представляют собой нелинейную краевую задачу. Желательно найти метод, 
позволяющий по условиям (6) на правом конце траектории вычислять начальные условия P(0)=C сопряженной 
системы уравнений. В этом случае вместо нелинейной задачи мы получим задачу Коши, для решения которой
 разработаны эффективные вычислительные методы.

<P><B>2.</B> При фиксированном <NOBR>X(0)=X<SUB>0</SUB></NOBR> решения уравнений 
<A HREF="#form1">(1)</A>, (4), (5) являются функциями времени <I>t</I> и начальных условий сопряженной 
системы P(0)=C, т.е.<BR>
<CENTER>X=X(t,C), P=P(t,C), U=U(X(t,C),P(t,C)) (7)<BR></CENTER><BR>
и, следовательно, условия <A HREF="#form6">(6)</A> при фиксированном <I>Т</I> дают систему уравнений <BR>
<A NAME="form8"></A>
<CENTER>P(t,C)=0 (8)</CENTER><BR>
относительно начальных условий сопряженной системы.<BR>
Решение системы (8) возможно только численными методами, например, каким либо из методов
 последовательных приближений. Оставим пока в стороне вопросы сходимости и определения 
начального приближения и рассмотрим использование метода Ньютона для решения системы 
уравнений (8). 

<P><B>3.</B> Применение метода Ньютона к уравнению (8) позволяет построить последовательность<BR> 
<A NAME="form9"></A>
<CENTER><IMG SRC="image99.gif" WIDTH=270 HEIGHT=54 ALIGN="MIDDLE"> (9),</CENTER>
<P>если задано начальное приближение C<SUP>0</SUP> и 
существуют матрицы <IMG SRC="image101.gif" WIDTH=89 HEIGHT=48 ALIGN="MIDDLE"> для C=C<SUB>i</SUB>,  
<IMG SRC="image103.gif" WIDTH=50 HEIGHT=24 ALIGN="MIDDLE"><BR>
Предполагая существование соответствующих частных производных, введем в рассмотрение 
матрицы<BR><A NAME="form10"></A>
<CENTER><IMG SRC="image104.gif" WIDTH=133 HEIGHT=41 ALIGN="MIDDLE">, 
<IMG SRC="image105.gif" WIDTH=129 HEIGHT=41 ALIGN="MIDDLE"> (10)</CENTER><BR>
размерности <NOBR>(n x n)</NOBR> и матрицу <BR>
<CENTER><IMG SRC="image106.gif" WIDTH=482 HEIGHT=41 ALIGN="MIDDLE"> (11)</CENTER><BR>
размерности <NOBR>(r x n)</NOBR>.<BR>
Из <A HREF="#form4">(4)</A>следует, что <CENTER><I><NOBR>U(t,C)= sign(B*P(t,C))</I></NOBR>, (12)</CENTER><BR>
где функция sign(x) понимается как покомпонентная, т.е. <BR><A NAME="form13"></A>
<CENTER><I><NOBR>U<SUB>i</SUB>(t,C)= sign(B*P(t,C)<SUB>i</SUB>)</I></NOBR>, 
<IMG SRC="image111.gif" WIDTH=46 HEIGHT=24 ALIGN="MIDDLE"> (13)</CENTER><BR>
В связи с (12) производные от <I>U</I> в (11) следует понимать в обобщенном смысле. 
Кроме того, в нашем случае <I>U</I> не зависит явно от <I>X(t, C)</I> и, следовательно, <BR>
<CENTER><IMG SRC="image112.gif" WIDTH=228 HEIGHT=44 ALIGN="MIDDLE">  (14)</CENTER><BR>
Продифференцировав с учетом <A HREF="#form10">(10)</A> и (14) соотношения <A HREF="#form1">(1)</A> и
 <A HREF="#form5">(5)</A> по <I>С</I>, получим матричные дифференциальные уравнения <BR>
<A NAME="form15"></A>
<CENTER><IMG SRC="image113.gif" WIDTH=230 HEIGHT=80 ALIGN="MIDDLE">  (15)</CENTER><BR>
которые вместе с очевидными начальными условиями <BR><A NAME="form16"></A>
<CENTER>X<SUB>c</SUB>(0,C)=0, P<SUB>c</SUB>(0,C)=E  (16)</CENTER><BR>
( <I>Е</I> - единичная матрица) и уравнениями <A HREF="#form1">(1)</A> и <A HREF="#form5">(5)</A> 
дают все необходимые соотношения для вычисления интересующей нас матрицы P<SUB>c</SUB>(T,C).

<P><B>4.</B> Из <A HREF="#form13">(13)</A> следует, что матрица 
<IMG SRC="image117.gif" WIDTH=74 HEIGHT=44 ALIGN="MIDDLE"> является 
диагональной с <IMG SRC="image118.gif" WIDTH=13 HEIGHT=18 ALIGN="MIDDLE">-функциями на диагонали. В связи 
с этим интегрирование уравнений (15) требует знания моментов смены знаков управляющих 
параметров, что, собственно и является главной проблемой в нашей задаче оптимального 
управления. Эти трудности можно преодолеть использованием более гладкой функции, чем в 
соотношении <A HREF="#form13">(13)</A>, но мало отличающейся от оптимальной по своему воздействию 
на управляемую систему. Вместо <I><NOBR>U<SUB>i</SUB>= sign((B*P)<SUB>i</SUB>)</I></NOBR>
  предлагается использовать, например, <A NAME="form17"></A>
<CENTER><IMG SRC="image120.gif" WIDTH=128 HEIGHT=24 ALIGN="MIDDLE"> , 
<IMG SRC="image121.gif" WIDTH=44 HEIGHT=24 ALIGN="MIDDLE">  (17)</CENTER><BR>
при достаточно больших значениях <I>g</I>.<BR>
Очевидно, в этом случае <IMG SRC="image122.gif" WIDTH=164 HEIGHT=21 ALIGN="MIDDLE">
 и вместо <IMG SRC="image125.gif" WIDTH=13 HEIGHT=18 ALIGN="MIDDLE">-функций при вычислении соответствующих 
производных можно использовать функции из <IMG SRC="image125.gif" WIDTH=13 HEIGHT=18 ALIGN="MIDDLE">
-образующей последовательности<BR><A NAME="form18"></A>
<CENTER><IMG SRC="image126.gif" WIDTH=250 HEIGHT=48 ALIGN="MIDDLE"> (18)</CENTER><BR>
Использование соотношений (17) и (18) при достаточно большом <I>g </I>позволяет 
провести численное интегрирование систем <A HREF="#form1">(1)</A>, <A HREF="#form5">(5)</A> 
и (17) без существенной потери точности.<BR>

<P><B>5.</B> Сходимость процедуры <A HREF="#form9">(9)</A> зависит от свойств матрицы P<SUB>c</SUB>(T,C)
 и близости начального приближения С<SUP>0</SUP> к искомому решению <A HREF="#lit2">[2]</A>. 
Проверка достаточных  условий сходимости в соответствии с <A HREF="#lit2">[2]</A> затруднительна, 
так как требует оценки вторых производных вектора P(T,C)  по C. Мы будем считать, что выполнено требование 
существования матрицы <!-- --><IMG SRC="image131.gif" WIDTH=68 HEIGHT=24 ALIGN="MIDDLE">, и сосредоточим внимание 
на получении начального приближения С<SUP>0</SUP> к искомому решению C.
Прежде всего отметим, что при фиксированном X<SUB>0</SUB> решение уравнения <A HREF="#form8">(8)</A> 
зависит только от времени управления <I>Т</I>, то есть <BR>
<CENTER>C=C(T) (19)</CENTER><BR>
Очевидно, что С(0)=0  и <I>P</I><SUB>c</SUB>(0,C)=<I>E</I>. Если <I>tп1&gt;0</I> - первый момент 
смены знака управляющих параметров в <A HREF="#form13">(13)</A>, то при <I>0</I>
<IMG SRC="image136.gif" WIDTH=13 HEIGHT=16 ALIGN="MIDDLE"><I>t&lt;tп1</I> системы 
<A HREF="#form1">(1)</A> и <A HREF="#form5">(5)</A> являются 
линейными. В этом случае процедура <A HREF="#form9">(9)</A> дает решение 
<IMG SRC="image137.gif" WIDTH=34 HEIGHT=20 ALIGN="MIDDLE"> на первом шаге итерации при С<SUP>0</SUP>=0 для любого <I>
<IMG SRC="image139.gif" WIDTH=12 HEIGHT=14 ALIGN="MIDDLE"></I>
<IMG SRC="image140.gif" WIDTH=13 HEIGHT=13 ALIGN="MIDDLE"><I>
[0,tп1].</I> Найденное решение <IMG SRC="image137.gif" WIDTH=34 HEIGHT=20 ALIGN="MIDDLE"> может быть 
использовано в качестве начального приближения для вычисления 
<IMG SRC="image141.gif" WIDTH=66 HEIGHT=21 ALIGN="MIDDLE"> при достаточно малом  
<IMG SRC="image142.gif" WIDTH=22 HEIGHT=18 ALIGN="MIDDLE">. Эту процедуру можно повторять пока не будет 
вычислено C(T) для заданного T. Некоторое обоснование описанной процедуры
 можно получить, исследовав завмсммость C от T.<BR>
Пусть P(0)=C(T). Тогда из уравнения <A HREF="#form5">(5)</A> и условия 
<A HREF="#form8">(8)</A> получаем<BR>
<CENTER><IMG SRC="image148.gif" WIDTH=389 HEIGHT=50 ALIGN="MIDDLE">. (20)</CENTER>
Последнее равенство должно выполняться тождественно по T. Предполагая существование соответствующих 
производных, дифференцируем (20) по T. Получим <BR>
<CENTER><IMG SRC="image150.gif" WIDTH=573 HEIGHT=48 ALIGN="MIDDLE">.   (21)</CENTER><BR>
Еще раз учитывая <A HREF="#form8">(8)</A> и второе из уравнений <A HREF="#form15">(15)</A>,  
из (20) получим <BR>
<CENTER><IMG SRC="image151.gif" WIDTH=336 HEIGHT=50 ALIGN="MIDDLE">.(22)</CENTER><BR>
Произведя интегрирование в левой части (22), с учетом <A HREF="#form8">(8)</A> и 
<A HREF="#form16">(16)</A> получим дифференциальное уравнение <BR><A NAME="form23"></A>
<CENTER><IMG SRC="image152.gif" WIDTH=244 HEIGHT=41 ALIGN="MIDDLE">, (23)</CENTER><BR>
которое с начальным условием C(0)=0 полностью решает задачу вычисления вектора <I>C(T)</I>
Уравнение (23) реализует некоторый непрерывный аналог описанной выше процедуры. Его 
непосредственное интегрирование очень трудоемко, так как вычисление правой части требует 
решения задачи Коши. Но при вычисленном значении <IMG SRC="image155.gif" WIDTH=34 HEIGHT=20 ALIGN="MIDDLE">, 
уравнение (23) можно использовать в процедуре <A HREF="#form9">(9)</A> для вычисления 
<IMG SRC="image156.gif" WIDTH=66 HEIGHT=21 ALIGN="MIDDLE"> с начальным приближением <BR>
<CENTER><IMG SRC="image157.gif" WIDTH=230 HEIGHT=46 ALIGN="MIDDLE">.  (24)</CENTER><BR>

<P><B>6.</B> Необходимо сказать несколько слов о выборе параметра <I>g</I>. Выше было сказано, 
что этот параметр должен быть достаточно большим. Критерием здесь может служить то, что 
дальнейшее увеличение <I>g</I> уже мало влияет на результат вычисления вектора C.<BR>
Однако параметр <I>g</I> можно использовать для вычисления начального приближения в
 процедуре <A HREF="#form9">(9)</A>. Дело в том, что при фиксированном T и использовании 
U<SUP>g</SUP>(B*P) вместо U(B*P), вектор С является функцией <I>g</I>, т.е. <BR>
<CENTER><IMG SRC="image162.gif" WIDTH=68 HEIGHT=20 ALIGN="MIDDLE">  (25)</CENTER><BR>
При этом вектор-функции X, P, и U<SUP>g</SUP>, описывающие поведение управляемой и сопряженной систем, 
зависят от <I>g</I> как непосредственно, так и через C(g),  т.е,<BR>
<CENTER><IMG SRC="image167.gif" WIDTH=122 HEIGHT=20 ALIGN="MIDDLE">
 <I>P=P(t,g,C(g)), U<SUP>g</SUP>(t,g,C(g))</I>. (26)</CENTER><BR>
Дифференцируем уравнения <A HREF="#form1">(1)</A> и <A HREF="#form5">(5)</A> при U=U<SUP>g</SUP> по 
<I>g</I>. Обозначая, как и ранее, частные производные соответствующими нижними индексами и 
учитывая <A HREF="#form15">(15)</A>, получим <BR>

<CENTER>
<TABLE>
<TR>
	<TD><IMG SRC="image171.gif" WIDTH=117 HEIGHT=33 ALIGN="MIDDLE">; </TD>
	<TD>X<SUB>g</SUB>(0,g,C(g))=0; </TD>
	<TD ROWSPAN=2 VALIGN=MIDLE> (27) </TD>
</TR>
<TR>
	<TD><IMG SRC="image173.gif" WIDTH=124 HEIGHT=33 ALIGN="MIDDLE">; </TD>
	<TD>P<SUB>g</SUB>(0,g,C(g))=0. </TD>
</TR>
</TABLE>
</CENTER>

Теперь, проделав такие же, как и в п.5 вычисления, получим уравнение для C(g):<BR>
<CENTER><IMG SRC="image176.gif" WIDTH=262 HEIGHT=44 ALIGN="MIDDLE">.  (28)</CENTER><BR>

При <I>g=0</I> уравнения <A HREF="#form1">(1)</A> и <A HREF="#form5">(5)</A> являются линейными 
и начальное условие для (28) вычисляется с помощью однократного применения процедуры 
<A HREF="#form9">(9)</A> при C(0)=0.<BR>
Уравнение (28) может быть использовано аналогично уравнению <A HREF="#form23">(23)</A> как для непосредственного вычисления 
C(g), так и для получения начального приближения в процедуре <A HREF="#form9">(9)</A>.<BR>

<P><B>7.</B> Для проверки работоспособности предлагаемой методики проведено ее численное 
моделирование в системе управления четвертого порядка (объект третьего порядка с 
ПИД-регулятором). Моделирование проводилось с определением начального приближения по 
п.5 и с аппроксимацией разрывного управления в соответствии с <A HREF="#form17">(17)</A> и 
<A HREF="#form18">(18)</A>.
<P>В процессе эксперимента время управления T менялось от 0 до 3
<IMG SRC="image179.gif" WIDTH=42 HEIGHT=14 ALIGN="MIDDLE"> 
(<IMG SRC="image179.gif" WIDTH=42 HEIGHT=14 ALIGN="MIDDLE"> 
- максимальная постоянная времени объекта). 
Параметр <I>g</I> изменялся от 1 до 10<SUP>10</SUP>.
При <I>g</I>=1<IMG SRC="image181.gif" WIDTH=14 HEIGHT=13 ALIGN="MIDDLE">100 заданная точность 
<IMG SRC="image182.gif" WIDTH=58 HEIGHT=21 ALIGN="MIDDLE"> определения C достигалась за 1
<IMG SRC="image181.gif" WIDTH=14 HEIGHT=13 ALIGN="MIDDLE">2 шага процедуры <A HREF="#form9">(9)</A> при любом 
значении T и C=0. Для <I>g</I>&gt;10<SUP>2</SUP> требования к определению С<SUP>0</SUP> ужесточались и, в 
соответствии с п.5, для определения  С<SUP>0</SUP> диапазон изменения T приходилось делить на интервалы 
<IMG SRC="image188.gif" WIDTH=16 HEIGHT=17 ALIGN="MIDDLE"> T 
<IMG SRC="image189.gif" WIDTH=14 HEIGHT=11 ALIGN="MIDDLE">0,1T. 
При этом заданная точность достигалась за 5
<IMG SRC="image181.gif" WIDTH=14 HEIGHT=13 ALIGN="MIDDLE">6 шагов 
процедуры (9). Для <I>g</I>&gt;10<SUP>5</SUP> результат вычислений и сходимость процедуры
 <A HREF="#form9">(9)</A> практически не зависели от <I>g</I>.<BR>
Интегрирование уравнений <A HREF="#form23">(23)</A> и (28) в процессе эксперимента не проводилось.<BR>

<P><B>8.</B> Предложенные методы вычисления начальных условий сопряженной системы требуют 
довольно большого объема вычислений. Однако они вполне пригодны как для управления 
медленно протекающими процессами в реальном времени, так и для получения эталонных 
траекторий в задаче генерирования правил нечеткого управления <A HREF="#lit3">[3]</A> или при организации 
скользящих режимов.
<P>
<B>Список литературы.</B><BR>
<OL><A NAME="lit1"></A>
<LI> Понтрягин Л.С., Болтянский В.Г., Гамкрелидзе Р.В., Мищенко Е.Ф.<BR> 
<B>Математическая теория оптимальных процессов.</B> <BR>
М: Физматгиз, 1961.<BR><A NAME="lit2"></A>
<LI> Бахвалов Н.С., Жидков Н.П., Кобельков Г.М. <BR>
<B>Численные методы.</B> <BR>
М.: Наука,1987.<BR><A NAME="lit3"></A>
<LI> Бобко В.Д., Золотухин Ю.Н., Нестеров А.А. <BR>
<B><A HREF="../folder7/nmb1.html">О нечеткой динамической коррекции параметров ПИД-регулятора.</A></B> <BR>
//Автометрия. 1998.-╬1.<BR>
</OL>

</BLOCKQUOTE>

<HR ALIGN=LEFT>
<P ALIGN=RIGHT>&copy;1997, 1998 Fuzzy Technologies Lab. <BR>
mailto: <A HREF="mailto:zolotukhin@iae.nsk.su">zolotukhin@iae.nsk.su</A></P>

</BODY>
</HTML>
